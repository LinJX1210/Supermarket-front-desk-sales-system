# 数据库字段命名规范

## 命名规则

- 表名：小写字母 + 下划线，如 `order_info`
- 字段名：小写字母 + 下划线，如 `create_time`
- 主键：`表名单数_id`，如 `user_id`、`order_id`
- 外键：关联表的主键名，如 `member_id`
- 时间字段：`xxx_time`，如 `create_time`、`update_time`
- 状态字段：`status` 或 `xxx_status`
- 标记字段：`is_xxx` 或 `xxx_flag`

---

## 一、用户与权限模块

### sys_user (系统用户表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| user_id | INT | 用户ID (主键) |
| username | VARCHAR(50) | 用户名 |
| password | VARCHAR(64) | 密码(MD5) |
| real_name | VARCHAR(50) | 真实姓名 |
| phone | VARCHAR(20) | 手机号 |
| role | ENUM | 角色: admin/cashier/goods_manager/after_sale |
| status | ENUM | 状态: active/disabled |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### sys_user_log (用户操作日志表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| log_id | INT | 日志ID (主键) |
| user_id | INT | 用户ID (外键) |
| operation | VARCHAR(100) | 操作内容 |
| operation_time | DATETIME | 操作时间 |
| ip_address | VARCHAR(50) | IP地址 |

---

## 二、会员管理模块

### member_level_rule (会员等级规则表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| rule_id | INT | 规则ID (主键) |
| level_name | VARCHAR(20) | 等级名称 |
| level_code | ENUM | 等级代码: normal/silver/gold |
| min_consume | DECIMAL(12,2) | 升级最低消费金额 |
| min_points | INT | 升级最低积分 |
| discount_rate | DECIMAL(3,2) | 折扣比例 (0.95=95折) |
| points_rate | INT | 积分比例 (1元=N积分) |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### member (会员表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| member_id | INT | 会员ID (主键) |
| user_id | INT | 关联用户ID (外键) |
| card_no | VARCHAR(20) | 会员卡号 |
| name | VARCHAR(50) | 会员姓名 |
| phone | VARCHAR(20) | 手机号 |
| address | VARCHAR(200) | 地址 |
| level_code | ENUM | 会员等级: normal/silver/gold |
| total_consume | DECIMAL(12,2) | 累计消费金额 |
| total_points | INT | 当前积分 |
| status | ENUM | 状态: active/disabled |
| create_time | DATETIME | 注册时间 |
| update_time | DATETIME | 更新时间 |

### member_change_log (会员变更记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| log_id | INT | 日志ID (主键) |
| member_id | INT | 会员ID (外键) |
| change_type | VARCHAR(50) | 变更类型: info/level_up/level_down/points |
| old_value | VARCHAR(200) | 变更前值 |
| new_value | VARCHAR(200) | 变更后值 |
| change_reason | VARCHAR(200) | 变更原因 |
| operator_id | INT | 操作人ID (外键) |
| change_time | DATETIME | 变更时间 |

---

## 三、商品管理模块

### goods_category (商品分类表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| category_id | INT | 分类ID (主键) |
| category_name | VARCHAR(50) | 分类名称 |
| parent_id | INT | 父分类ID (外键) |
| level | TINYINT | 层级: 1-课/2-类/3-种 |
| sort_order | INT | 排序号 |
| delete_flag | TINYINT | 删除标记: 0-正常/1-已删除 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### shelf_area (货架区域表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| area_id | INT | 区域ID (主键) |
| area_code | VARCHAR(10) | 区域编码 (A/B/C) |
| area_name | VARCHAR(50) | 区域名称 |
| description | VARCHAR(200) | 区域描述 |
| create_time | DATETIME | 创建时间 |

### shelf (货架表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| shelf_id | INT | 货架ID (主键) |
| area_id | INT | 所属区域ID (外键) |
| shelf_code | VARCHAR(20) | 货架编码 (A-01-02) |
| shelf_no | VARCHAR(10) | 货架号 |
| layer_no | VARCHAR(10) | 层号 |
| capacity | INT | 容量 |
| create_time | DATETIME | 创建时间 |

### goods (商品表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| goods_id | INT | 商品ID (主键) |
| barcode | VARCHAR(50) | 商品条码 |
| goods_name | VARCHAR(100) | 商品名称 |
| category_id | INT | 分类ID (外键) |
| unit | VARCHAR(20) | 单位 |
| is_weighted | TINYINT | 是否散装称重: 0-否/1-是 |
| price | DECIMAL(10,2) | 销售单价 |
| cost_price | DECIMAL(10,2) | 成本价 |
| shelf_id | INT | 货架ID (外键) |
| shelf_status | ENUM | 上架状态: pending_shelf/on_shelf/off_shelf/pending_inspect/suspend_sale |
| discount | DECIMAL(3,2) | 临时折扣 (0.8=8折) |
| discount_start | DATETIME | 折扣开始时间 |
| discount_end | DATETIME | 折扣结束时间 |
| off_shelf_reason | VARCHAR(200) | 下架原因 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### inventory (库存表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| inventory_id | INT | 库存ID (主键) |
| goods_id | INT | 商品ID (外键) |
| stock_num | INT | 库存数量(仓库) |
| on_shelf_num | INT | 在架数量 |
| stock_warning | INT | 库存警戒值 |
| shelf_warning | INT | 在架警戒值 |
| stock_status | ENUM | 库存状态: sufficient/stock_shortage/shelf_shortage |
| update_time | DATETIME | 更新时间 |

### goods_operation_log (商品操作记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| log_id | INT | 日志ID (主键) |
| goods_id | INT | 商品ID (外键) |
| operation_type | VARCHAR(50) | 操作类型: on_shelf/off_shelf/move_shelf/price_change/discount_set |
| old_value | VARCHAR(200) | 变更前值 |
| new_value | VARCHAR(200) | 变更后值 |
| operator_id | INT | 操作人ID (外键) |
| operation_time | DATETIME | 操作时间 |
| remark | VARCHAR(200) | 备注 |

---

## 四、订单与收银模块

### order_info (订单表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| order_id | INT | 订单ID (主键) |
| order_no | VARCHAR(30) | 订单号 |
| member_id | INT | 会员ID (外键) |
| cashier_id | INT | 收银员ID (外键) |
| total_amount | DECIMAL(12,2) | 订单总金额 |
| discount_amount | DECIMAL(12,2) | 折扣金额 |
| actual_amount | DECIMAL(12,2) | 实付金额 |
| points_earned | INT | 本单获得积分 |
| points_used | INT | 本单使用积分 |
| order_status | ENUM | 订单状态: pending_pay/hanged/completed/cancelled/full_returned/part_returned |
| create_time | DATETIME | 创建时间 |
| complete_time | DATETIME | 完成时间 |

### order_detail (订单明细表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| detail_id | INT | 明细ID (主键) |
| order_id | INT | 订单ID (外键) |
| goods_id | INT | 商品ID (外键) |
| goods_name | VARCHAR(100) | 商品名称(冗余) |
| barcode | VARCHAR(50) | 商品条码(冗余) |
| unit_price | DECIMAL(10,2) | 单价 |
| quantity | DECIMAL(10,3) | 数量/重量 |
| discount | DECIMAL(3,2) | 折扣 |
| subtotal | DECIMAL(12,2) | 小计金额 |
| is_returned | TINYINT | 是否已退货: 0-否/1-是 |
| returned_quantity | DECIMAL(10,3) | 已退货数量 |

### payment_record (支付记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| payment_id | INT | 支付ID (主键) |
| order_id | INT | 订单ID (外键) |
| payment_type | ENUM | 支付方式: cash/bank_card/coupon/points |
| amount | DECIMAL(12,2) | 支付金额 |
| transaction_type | ENUM | 交易类型: pay/refund |
| payment_time | DATETIME | 支付时间 |

---

## 五、退货管理模块

### return_record (退货记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| return_id | INT | 退货ID (主键) |
| return_no | VARCHAR(30) | 退货单号 |
| order_id | INT | 原订单ID (外键) |
| return_type | ENUM | 退货类型: full/part |
| refund_amount | DECIMAL(12,2) | 退款金额 |
| points_deducted | INT | 扣减积分 |
| return_reason | ENUM | 退货原因: quality_issue/no_reason_7day/spec_mismatch/damaged/other |
| reason_detail | VARCHAR(500) | 原因详情 |
| quality_photo | VARCHAR(500) | 质量问题照片路径 |
| operator_id | INT | 售后管理员ID (外键) |
| return_status | ENUM | 退货状态: pending/completed/rejected |
| create_time | DATETIME | 退货时间 |

### return_detail (退货明细表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| detail_id | INT | 明细ID (主键) |
| return_id | INT | 退货ID (外键) |
| order_detail_id | INT | 原订单明细ID (外键) |
| goods_id | INT | 商品ID (外键) |
| return_quantity | DECIMAL(10,3) | 退货数量 |
| refund_amount | DECIMAL(12,2) | 退款金额 |
| return_reason | ENUM | 退货原因 |
| goods_status | ENUM | 商品去向: to_stock/pending_inspect/off_shelf/repaired |

### quality_feedback (质量问题反馈表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| feedback_id | INT | 反馈ID (主键) |
| return_id | INT | 退货ID (外键) |
| goods_id | INT | 商品ID (外键) |
| barcode | VARCHAR(50) | 商品条码 |
| problem_desc | VARCHAR(500) | 问题描述 |
| photo_path | VARCHAR(500) | 问题照片路径 |
| feedback_status | ENUM | 反馈状态: pending/processing/completed |
| handle_result | ENUM | 处理结果: batch_off_shelf/single_off_shelf/repair/no_action |
| handle_remark | VARCHAR(500) | 处理备注 |
| handler_id | INT | 处理人ID (外键) |
| create_time | DATETIME | 创建时间 |
| handle_time | DATETIME | 处理时间 |
| last_remind_time | DATETIME | 上次提醒时间 |

---

## 六、积分兑换模块

### gift (礼品表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| gift_id | INT | 礼品ID (主键) |
| gift_name | VARCHAR(100) | 礼品名称 |
| gift_desc | VARCHAR(500) | 礼品描述 |
| points_required | INT | 所需积分 |
| stock_num | INT | 库存数量 |
| status | ENUM | 状态: active/inactive |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### points_exchange_record (积分兑换记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| record_id | INT | 记录ID (主键) |
| member_id | INT | 会员ID (外键) |
| exchange_type | ENUM | 兑换类型: gift/cash |
| gift_id | INT | 礼品ID (外键) |
| points_used | INT | 使用积分 |
| cash_amount | DECIMAL(10,2) | 抵扣金额 |
| order_id | INT | 关联订单ID (外键) |
| operator_id | INT | 操作人ID (外键) |
| exchange_time | DATETIME | 兑换时间 |

---

## 七、入库模块

### stock_in_record (入库记录表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| record_id | INT | 入库记录ID (主键) |
| goods_id | INT | 商品ID (外键) |
| quantity | INT | 入库数量 |
| batch_no | VARCHAR(50) | 批次号 |
| supplier | VARCHAR(100) | 供应商 |
| cost_price | DECIMAL(10,2) | 进货价 |
| operator_id | INT | 操作人ID (外键) |
| create_time | DATETIME | 入库时间 |
| remark | VARCHAR(200) | 备注 |

---

## 八、系统通知模块

### sys_notification (系统通知表)
| 字段名 | 类型 | 说明 |
|-------|------|------|
| notification_id | INT | 通知ID (主键) |
| target_user_id | INT | 目标用户ID (外键) |
| target_role | ENUM | 目标角色: admin/cashier/goods_manager/after_sale |
| notification_type | VARCHAR(50) | 通知类型: stock_warning/quality_feedback/member_upgrade/member_downgrade |
| title | VARCHAR(100) | 通知标题 |
| content | TEXT | 通知内容 |
| related_id | INT | 关联业务ID |
| is_read | TINYINT | 是否已读: 0-未读/1-已读 |
| create_time | DATETIME | 创建时间 |
| read_time | DATETIME | 阅读时间 |

---

## 枚举值速查

### 角色 (role)
- `admin` - 系统管理员
- `cashier` - 收银员
- `goods_manager` - 商品管理员
- `after_sale` - 售后管理员

### 会员等级 (level_code)
- `normal` - 普通会员
- `silver` - 银卡会员
- `gold` - 金卡会员

### 商品上架状态 (shelf_status)
- `pending_shelf` - 待上架
- `on_shelf` - 在架
- `off_shelf` - 已下架
- `pending_inspect` - 待质检
- `suspend_sale` - 暂停销售

### 订单状态 (order_status)
- `pending_pay` - 待结账
- `hanged` - 挂单中
- `completed` - 已完成
- `cancelled` - 已撤销
- `full_returned` - 已整单退货
- `part_returned` - 部分退货

### 支付方式 (payment_type)
- `cash` - 现金
- `bank_card` - 银行卡
- `coupon` - 赠券
- `points` - 积分

### 退货原因 (return_reason)
- `quality_issue` - 质量问题
- `no_reason_7day` - 7天无理由
- `spec_mismatch` - 规格不符
- `damaged` - 损坏
- `other` - 其他
